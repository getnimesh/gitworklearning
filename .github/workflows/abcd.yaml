name: Test Restriction

on:
    push:
        branches:
            - main
    pull_request:
        types:
            - opened
            - synchronize

jobs:
    build:
        runs-on: ubuntu-latest

        steps:
            - name: Checkout code
              uses: actions/checkout@v4

            - name: Get actor name
              run: echo "Actor name ${{ github.actor }}"

            - name: Check for changes in common/abc.py
              id: check_changes
              run: |
                echo git diff --name-only ${{ github.sha }} HEAD
                if git diff --name-only ${{ github.sha }} HEAD | grep -q '^common/abc.py$'; then
                  echo "common/abc.py was modified in this pull request."
                  echo "::set-output name=changed::true"
                else
                  echo "common/abc.py was NOT modified in this pull request."
                  echo "::set-output name=changed::false"
                fi

            - name: Use the output
              run: |
                if [[ "${{ steps.check_changes.outputs.changed }}" == "true" ]]; then
                  # Perform actions if common/dag.py was modified
                  echo "Performing actions because common/dag.py was modified."
                else
                  echo "No further actions needed."
                fi